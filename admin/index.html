<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Login | Color Hut Studio</title>
    <link rel="icon" type="image/png" href="/logo.png">

    <!-- Social Sharing Meta Tags (Open Graph) -->
    <meta property="og:title" content="Admin Login | Color Hut Studio">
    <meta property="og:description" content="Secure portal to manage Color Hut branding and creative solutions.">
    <meta property="og:image" content="https://store.colorhutbd.xyz/preview.png">
    <meta property="og:url" content="https://store.colorhutbd.xyz/admin/login">
    <meta property="og:type" content="website">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Admin Login | Color Hut Studio">
    <meta name="twitter:description" content="Secure portal to manage Color Hut branding and creative solutions.">
    <meta name="twitter:image" content="https://store.colorhutbd.xyz/preview.png">

    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: radial-gradient(circle at top right, #f8fafc, #f1f5f9);
        }

        .studio-card {
            background: #ffffff;
            box-shadow:
                0 10px 25px -5px rgba(0, 0, 0, 0.04),
                0 8px 10px -6px rgba(0, 0, 0, 0.04);
        }

        .input-field {
            background: #fdfdfd;
            border: 1px solid #e2e8f0;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .input-field:focus {
            border-color: #000000;
            background: #fff;
            box-shadow: 0 0 0 4px rgba(0, 0, 0, 0.03);
        }
    </style>
</head>

<body class="min-h-screen flex items-center justify-center p-6 text-slate-900">

    <div class="w-full max-w-[400px]">
        <div class="flex justify-center mb-8">
            <div class="w-12 h-12 bg-black rounded-full flex items-center justify-center shadow-lg shadow-black/10">
                <div class="w-5 h-5 border-2 border-white rounded-sm rotate-45"></div>
            </div>
        </div>

        <!-- Notifications will be shown via Toast -->

        <div class="studio-card rounded-[2.5rem] p-10 border border-white">
            <header class="text-center mb-10">
                <h1 class="text-2xl font-bold text-slate-900 tracking-tight">Welcome Back</h1>
                <p class="text-slate-500 text-sm mt-1 font-medium">Sign in to manage your studio</p>
            </header>

            <form id="loginForm" onsubmit="handleLogin(event)" class="space-y-6">
                <!-- Email -->
                <div class="space-y-2">
                    <label class="text-[11px] font-bold text-slate-400 uppercase tracking-widest ml-1">Email
                        Address</label>
                    <div class="relative group">
                        <div
                            class="absolute left-4 top-1/2 -translate-y-1/2 text-slate-400 group-focus-within:text-black transition-colors">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path
                                    d="M16 12a4 4 0 10-8 0 4 4 0 008 0zm0 0v1.5a2.5 2.5 0 005 0V12a9 9 0 10-9 9m4.5-1.206a5.5 5.5 0 11-5.5-5.5"
                                    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                            </svg>
                        </div>
                        <input type="email" id="email" required
                            class="w-full input-field rounded-xl pl-12 pr-4 py-3.5 text-slate-900 placeholder-slate-400 focus:outline-none font-medium text-sm"
                            placeholder="name@studio.com">
                    </div>
                </div>

                <!-- Password -->
                <div class="space-y-2">
                    <div class="flex justify-between items-center px-1">
                        <label class="text-[11px] font-bold text-slate-400 uppercase tracking-widest">Password</label>
                    </div>
                    <div class="relative group">
                        <div
                            class="absolute left-4 top-1/2 -translate-y-1/2 text-slate-400 group-focus-within:text-black transition-colors">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path
                                    d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"
                                    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                            </svg>
                        </div>
                        <input type="password" id="password" required
                            class="w-full input-field rounded-xl pl-12 pr-12 py-3.5 text-slate-900 placeholder-slate-400 focus:outline-none font-medium text-sm"
                            placeholder="••••••••">
                        <button type="button" onclick="togglePasswordVisibility()"
                            class="absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 hover:text-black transition-colors focus:outline-none">
                            <svg id="eyeIconOpen" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round" />
                                <path
                                    d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"
                                    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                            </svg>
                            <svg id="eyeIconClosed" class="w-5 h-5 hidden" fill="none" stroke="currentColor"
                                viewBox="0 0 24 24">
                                <path
                                    d="M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88L4.27 4.27m5.61 5.61l1.415 1.415m0 0l1.415 1.415M14.12 14.12l5.61 5.61m-5.61-5.61l-1.415-1.415m0 0l-1.415-1.415M21.542 12a10.048 10.048 0 00-2.458-3.927M18 6l6 6"
                                    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                            </svg>
                        </button>
                    </div>
                </div>

                <!-- Remember Me -->
                <div class="flex items-center group cursor-pointer w-fit">
                    <div class="relative flex items-center">
                        <input type="checkbox" id="rememberMe" class="peer h-5 w-5 opacity-0 absolute cursor-pointer">
                        <div
                            class="h-5 w-5 border-2 border-slate-200 rounded-md peer-checked:bg-black peer-checked:border-black transition-all flex items-center justify-center">
                            <svg class="w-3 h-3 text-white hidden peer-checked:block" fill="none" stroke="currentColor"
                                viewBox="0 0 24 24" stroke-width="4">
                                <path d="M5 13l4 4L19 7"></path>
                            </svg>
                        </div>
                        <label for="rememberMe"
                            class="ml-3 text-sm text-slate-500 font-medium cursor-pointer group-hover:text-slate-800 transition-colors">Remember
                            Me</label>
                    </div>
                </div>

                <!-- Action Button -->
                <button type="submit"
                    class="w-full bg-slate-900 text-white font-semibold py-4 rounded-xl hover:bg-black hover:shadow-xl hover:shadow-black/10 active:scale-[0.98] transition-all duration-200">
                    Sign In
                </button>
            </form>
        </div>

        <div class="mt-8 text-center">
            <span class="text-[10px] text-slate-400 font-bold uppercase tracking-[0.3em]">Studio OS &copy; 2026</span>
        </div>
    </div>

    <script>
        // Load saved credentials on page load and auto-login
        window.addEventListener('DOMContentLoaded', () => {
            const savedEmail = localStorage.getItem('adminEmail');
            const savedPassword = localStorage.getItem('adminPassword');
            const rememberMe = localStorage.getItem('rememberMe') === 'true';

            if (rememberMe && savedEmail && savedPassword) {
                document.getElementById('email').value = savedEmail;
                document.getElementById('password').value = savedPassword;
                document.getElementById('rememberMe').checked = true;

                // Auto-login with saved credentials
                autoLogin(savedEmail, savedPassword);
            }
        });

        function autoLogin(email, password) {
            const loginForm = document.getElementById('loginForm');
            const btn = loginForm.querySelector('button');
            const originalText = btn.innerHTML;

            // Show loading state
            btn.innerHTML = `<span class="flex items-center justify-center"><svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Auto-signing in...</span>`;
            btn.classList.add('opacity-80', 'cursor-not-allowed');
            btn.disabled = true;

            fetch('/admin/login', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ email, password })
            })
                .then(response => {
                    if (response.redirected) {
                        showToast('Welcome back! Redirecting...', 'success');
                        setTimeout(() => {
                            window.location.href = response.url;
                        }, 1500);
                    } else if (!response.ok) {
                        localStorage.removeItem('adminEmail');
                        localStorage.removeItem('adminPassword');
                        localStorage.removeItem('rememberMe');
                        btn.innerHTML = originalText;
                        btn.classList.remove('opacity-80', 'cursor-not-allowed');
                        btn.disabled = false;
                        document.getElementById('rememberMe').checked = false;
                        showToast('Session expired. Please login again.', 'error');
                    }
                })
                .catch(error => {
                    // On error, reset the form
                    btn.innerHTML = originalText;
                    btn.classList.remove('opacity-80', 'cursor-not-allowed');
                    btn.disabled = false;
                });
        }

        function handleLogin(e) {
            e.preventDefault();
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const rememberMe = document.getElementById('rememberMe').checked;

            if (email && password) {
                const btn = e.target.querySelector('button');
                const originalText = btn.innerHTML;

                // Loading state
                btn.innerHTML = `<span class="flex items-center justify-center"><svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Verifying...</span>`;
                btn.classList.add('opacity-80', 'cursor-not-allowed');
                btn.disabled = true;

                // Submit form to server
                fetch('/admin/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ email, password })
                })
                    .then(response => {
                        if (response.redirected) {
                            showToast('Login successful! Redirecting...', 'success');

                            // Save credentials if Remember Me is checked
                            if (rememberMe) {
                                localStorage.setItem('adminEmail', email);
                                localStorage.setItem('adminPassword', password);
                                localStorage.setItem('rememberMe', 'true');
                            } else {
                                // Clear saved credentials if not checked
                                localStorage.removeItem('adminEmail');
                                localStorage.removeItem('adminPassword');
                                localStorage.removeItem('rememberMe');
                            }

                            setTimeout(() => {
                                window.location.href = response.url;
                            }, 1500);
                        } else if (!response.ok) {
                            return response.text().then(text => {
                                throw new Error(text || 'Invalid credentials');
                            });
                        }
                    })
                    .catch(error => {
                        btn.innerHTML = originalText;
                        btn.classList.remove('opacity-80', 'cursor-not-allowed');
                        btn.disabled = false;
                        showToast(error.message || 'Verification failed. Please check your credentials.', 'error');
                    });
            }
        }

        function showToast(message, type) {
            const toast = document.createElement('div');
            const bgColor = type === 'success' ? 'bg-slate-900 border-slate-800' : 'bg-red-600 border-red-500';
            const iconBg = type === 'success' ? 'bg-emerald-500' : 'bg-white/20';
            const icon = type === 'success'
                ? '<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M5 13l4 4L19 7" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" /></svg>'
                : '<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M6 18L18 6M6 6l12 12" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" /></svg>';

            toast.className = `fixed bottom-8 left-1/2 -translate-x-1/2 ${bgColor} text-white px-6 py-4 rounded-2xl shadow-2xl z-[9999] flex items-center gap-3 border font-medium text-sm min-w-[320px]`;
            toast.innerHTML = `
                <div class="w-6 h-6 ${iconBg} rounded-full flex items-center justify-center flex-shrink-0">
                    ${icon}
                </div>
                <span>${message}</span>
            `;

            document.body.appendChild(toast);

            setTimeout(() => {
                toast.remove();
            }, 3000);
        }

        function togglePasswordVisibility() {
            const passwordInput = document.getElementById('password');
            const eyeOpen = document.getElementById('eyeIconOpen');
            const eyeClosed = document.getElementById('eyeIconClosed');

            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                eyeOpen.classList.add('hidden');
                eyeClosed.classList.remove('hidden');
            } else {
                passwordInput.type = 'password';
                eyeOpen.classList.remove('hidden');
                eyeClosed.classList.add('hidden');
            }
        }
    </script>
</body>

</html>